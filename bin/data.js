// Generated by CoffeeScript 1.10.0
(function() {
  'use strict';
  var _empty, addData, goodApiKey,
    indexOf = [].indexOf || function(item) { for (var i = 0, l = this.length; i < l; i++) { if (i in this && this[i] === item) return i; } return -1; };

  goodApiKey = function(req) {
    var headers;
    headers = Object.keys(req.headers);
    return indexOf.call(headers, "x-cloudmine-apikey") >= 0;
  };

  _empty = function(obj) {
    return Object.keys(obj).length === 0;
  };

  addData = function(req) {
    var payload;
    payload = req.payload != null ? req.payload : {};
    req.data = {
      apikey: req.headers["x-cloudmine-apikey"],
      request: {
        method: req.method.toUpperCase()
      },
      input: payload,
      params: _empty(req.query) ? payload : req.query
    };
    if (!_empty(payload)) {
      return req.data.request["content-type"] = req.mime;
    }
  };

  module.exports = {
    add: addData,
    goodApiKey: goodApiKey
  };

}).call(this);
